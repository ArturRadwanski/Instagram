{"version":3,"file":"main.js","mappings":"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","sources":["webpack://instagram/./src/app/fileController.ts","webpack://instagram/./src/app/getRequestData.ts","webpack://instagram/./src/app/imageRouter.ts","webpack://instagram/./src/app/model.ts","webpack://instagram/./src/app/tagsRouter.ts","webpack://instagram/external commonjs \"formidable\"","webpack://instagram/external commonjs \"http\"","webpack://instagram/external node-commonjs \"fs\"","webpack://instagram/webpack/bootstrap","webpack://instagram/webpack/runtime/compat get default export","webpack://instagram/webpack/runtime/define property getters","webpack://instagram/webpack/runtime/hasOwnProperty shorthand","webpack://instagram/webpack/runtime/make namespace object","webpack://instagram/./src/index.ts"],"sourcesContent":["import * as formidable from 'formidable';\nimport * as fs from 'fs';\n\nclass FileControllerClass\n{\n\ncreateAlbum(name: String): void\n{\n    fs.mkdirSync(`./albums/${name}`)\n}\n\nuploadPhoto(name: String, album: String)\n{\n    if(!fs.existsSync(`./albums/${album}`))\n        this.createAlbum(album)\n    fs.renameSync(`./temp/${name}`, `./albums/${album}/${name}`)\n}\n\n}\nconst FileController = new FileControllerClass()\nexport default FileController\n","import { IncomingMessage } from \"http\";\r\n\r\nexport async function getPostData(req: IncomingMessage)\r\n{\r\n    return new Promise((resolve, reject) =>{\r\n        try {\r\n            let body = \"\"\r\n\r\n            req.on(\"data\", part => {\r\n                body += part.toString()\r\n            })\r\n    \r\n            req.on(\"end\", () => {\r\n                resolve(body)\r\n            })\r\n    \r\n        }\r\n        catch (err)\r\n        {\r\n            reject(err)\r\n        }\r\n        \r\n    })\r\n}","import * as formidable from \"formidable\";\nimport { IncomingMessage, ServerResponse } from \"http\";\nimport FileController from \"./fileController\";\nimport { getPostData } from \"./getRequestData\";\n\nexport default async function imageRouter(\n  req: IncomingMessage,\n  res: ServerResponse\n) {\n  switch (req.method) {\n    case \"GET\":\n      const [path, params] = req.url.split(/\\?/);\n      if (path == \"/api/photos\") {\n        res.statusCode = 200;\n        res.setHeader(\"content-type\", \"image/jpg\");\n        //pobierz wszystkie\n        res.end();\n      } else if (req.url.match(/api\\/photos\\/[0-9]*/)) {\n        res.statusCode = 200;\n        res.setHeader(\"content-type\", \"image/jpg\");\n        //pobierz jedno zdjęcie\n        res.end();\n      }\n      break;\n    case \"POST\":\n      if (req.url == \"/api/photos\") {\n        const form = formidable({ multiples: true, uploadDir: \"./temp\" });\n        form.parse(req, (err, fields, files) => {\n          if (err) {\n            res.statusCode = err.httpCode || 404;\n            res.statusMessage = String(err);\n            res.end();\n            return;\n          }\n\n          FileController.uploadPhoto((files.file as unknown as formidable.File).newFilename, (fields as unknown as{album: String}).album)\n          res.statusCode = 200;\n          res.setHeader(\"content-type\", \"application/json\");\n          res.end(JSON.stringify({ ok: \"ok\" }));\n        });\n      }\n      break;\n    case \"DELETE\":\n      if (req.url.match(/api\\/photos\\/[0-9a-zA-Z]*/)) {\n        res.statusCode = 200;\n        res.setHeader(\"content-type\", \"application/json\");\n\n        //usun zdjecie i zwroc jego json\n        res.end();\n      }\n      break;\n    case \"PATCH\":\n      if (req.url.match(/api\\/photos\\/[0-9]*/)) {\n        res.statusCode = 200;\n        res.setHeader(\"content-type\", \"application/json\");\n        const body = await getPostData(req)\n        //edytuj jedno zdjecie\n        res.end(JSON.stringify(body));\n      }\n      break;\n  }\n}\n","interface singleChange \n{\n    status: String,\n    lastModifiedDate: String\n}\n\nexport interface PhotoData {\n    id: String,\n    album: String,\n    originalName: String,\n    url: String,\n    lastChange: String,\n    history: singleChange[]\n}\n\nexport interface TagData {\n    id: number,\n    name: String,\n    popularity:number\n}\nexport const tagsList:TagData[] = [\n    {\n        \"id\": 0,\n        \"name\": \"#love\",\n        \"popularity\": 0\n   },\n   {\n        \"id\": 1,\n        \"name\": \"#instagood\",\n        \"popularity\": 0\n   },\n   {\n        \"id\": 2,\n        \"name\": \"#fashion\",\n        \"popularity\": 0\n   },\n   {\n        \"id\": 3,\n        \"name\": \"#photooftheday\",\n        \"popularity\": 0\n   },\n   {\n        \"id\": 4,\n        \"name\": \"#beautiful\",\n        \"popularity\": 0\n   },\n   {\n        \"id\": 5,\n        \"name\": \"#art\",\n        \"popularity\": 0\n   }\n]\n\nexport const photoList:PhotoData[] = []\n","import { IncomingMessage, ServerResponse } from \"http\";\r\nimport { url } from \"inspector\";\r\nimport { getPostData } from \"./getRequestData\";\r\nimport { tagsList } from \"./model\";\r\n\r\nexport default function tagRouter(\r\n  req: IncomingMessage,\r\n  res: ServerResponse<IncomingMessage>\r\n) {\r\n  switch (req.method) {\r\n    case \"GET\":\r\n      const [path, args] = req.url.split(\"?\");\r\n      if (path.match(/raw/)) {\r\n        res.statusCode = 200;\r\n        res.statusMessage = \"ok\";\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n\r\n        const stringList = tagsList.map((tag) => {\r\n          return tag.name;\r\n        });\r\n        res.write(JSON.stringify(stringList));\r\n        res.end();\r\n      } else if (path.match(/tags$/)) {\r\n        res.statusCode = 200;\r\n        res.statusMessage = \"ok\";\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n        res.write(JSON.stringify(tagsList));\r\n        res.end();\r\n      } else if (path.match(/tag\\/[0-9]*/)) {\r\n        const id = path.split(/\\/tags\\//)[1] as unknown as number;\r\n        const tag = tagsList.find((tag) => tag.id == id);\r\n\r\n        res.statusCode = 200;\r\n        res.statusMessage = \"ok\";\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n        res.write(JSON.stringify(tag));\r\n        res.end();\r\n      }\r\n      break;\r\n\r\n    case \"POST\":\r\n      if (path.match(/^\\/api\\/tags$/)) {\r\n        getPostData(req).then((body) => {\r\n          const params = new URLSearchParams(body as string);\r\n          const obj = Object.fromEntries(params) as unknown as {\r\n            name: string,\r\n            popularity: number\r\n          };\r\n\r\n          if(tagsList.findIndex(tag => tag.name == obj.name) == -1)\r\n          {\r\n            res.statusCode = 201;\r\n            res.statusMessage = \"ok\";\r\n            res.setHeader(\"content-type\", \"text/txt\")\r\n            res.end(`Dodano tag: ${obj.name}`);\r\n          }\r\n          else{\r\n            res.statusCode = 400\r\n            res.statusMessage = \"already exists\"\r\n            res.setHeader(\"content-type\", \"text/txt\")\r\n            res.end(`Tag ${obj.name} już istnieje`)\r\n          }\r\n          \r\n        });\r\n      }\r\n      break;\r\n\r\n    case \"PATCH\":\r\n        if(req.url.match(/api\\/photos\\/tags/))\r\n        break;\r\n  }\r\n  return;\r\n}\r\n","module.exports = require(\"formidable\");","module.exports = require(\"http\");","module.exports = require(\"fs\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { createServer } from \"http\";\nconst PORT = 3000;\nimport imageRouter from \"./app/imageRouter\";\nimport tagRouter from \"./app/tagsRouter\";\n\nconst server = createServer((req, res) => {\n\n  if(req.url.match(/tags/))\n    tagRouter(req, res);\n  else if(req.url.match(/\\/api\\/photos/))\n    imageRouter(req, res);\n\n});\n\nserver.listen(PORT, () => {\n  console.log(\"Start on \" + PORT);\n});\n"],"names":[],"sourceRoot":""}