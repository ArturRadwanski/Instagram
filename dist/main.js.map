{"version":3,"file":"main.js","mappings":"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","sources":["webpack://instagram/./src/app/controller/fileController.ts","webpack://instagram/./src/app/controller/filtersController.ts","webpack://instagram/./src/app/controller/tagsController.ts","webpack://instagram/./src/app/controller/userController.ts","webpack://instagram/./src/app/getRequestData.ts","webpack://instagram/./src/app/model.ts","webpack://instagram/./src/app/router/filtersRouter.ts","webpack://instagram/./src/app/router/imageRouter.ts","webpack://instagram/./src/app/router/tagsRouter.ts","webpack://instagram/./src/app/router/userRouter.ts","webpack://instagram/external commonjs \"bcryptjs\"","webpack://instagram/external commonjs \"dotenv\"","webpack://instagram/external commonjs \"formidable\"","webpack://instagram/external commonjs \"http\"","webpack://instagram/external commonjs \"jsonwebtoken\"","webpack://instagram/external commonjs \"sharp\"","webpack://instagram/external node-commonjs \"fs\"","webpack://instagram/webpack/bootstrap","webpack://instagram/webpack/runtime/compat get default export","webpack://instagram/webpack/runtime/define property getters","webpack://instagram/webpack/runtime/hasOwnProperty shorthand","webpack://instagram/webpack/runtime/make namespace object","webpack://instagram/./src/index.ts"],"sourcesContent":["import * as formidable from \"formidable\";\r\nimport * as fs from \"fs\";\r\nimport {\r\n  nextPhotoId,\r\n  nextPostId,\r\n  photoList,\r\n  post,\r\n  postList,\r\n  userList,\r\n} from \"../model\";\r\nimport userController from \"./userController\";\r\nimport userRouter from \"../router/userRouter\";\r\n\r\nclass FileControllerClass {\r\n  createAlbum(name: string): void {\r\n    fs.mkdirSync(`./albums/${name}`);\r\n  }\r\n\r\n  uploadPhoto(name: string, album: string, userId: number) {\r\n    if (!fs.existsSync(`./albums/${album}`)) this.createAlbum(album);\r\n    fs.renameSync(`./temp/${name}`, `./albums/${album}/${name}`);\r\n    photoList.push({\r\n      id: nextPhotoId.id,\r\n      album: album,\r\n      originalName: name,\r\n      url: `./albums/${album}/${name}`,\r\n      lastChange: Date.now().toLocaleString(),\r\n      history: [],\r\n      tagList: [],\r\n      userId,\r\n    });\r\n    return photoList[photoList.length - 1];\r\n  }\r\n\r\n  findPhotoById(id: number) {\r\n    return photoList.find((el) => el.id == id);\r\n  }\r\n\r\n  createNewPost(\r\n    title: string,\r\n    content: string,\r\n    photoId: number[],\r\n    email: string\r\n  ) {\r\n    const user = userList.find((val) => val.email == email);\r\n    const post: post = {\r\n      title,\r\n      content,\r\n      photoId,\r\n      id: nextPostId.id,\r\n      userId: user.id,\r\n      email: user.email,\r\n    };\r\n    postList.push(post);\r\n    return;\r\n  }\r\n\r\n  deletePost(id: number, email: string) {\r\n    const post = postList.findIndex((val) => val.id == id);\r\n    if (postList[post].email == email) {\r\n      const [x] = postList.slice(post, post + 1);\r\n      return x;\r\n    }\r\n    return false;\r\n  }\r\n  deletePhoto(id: number) {}\r\n}\r\n\r\nconst FileController = new FileControllerClass();\r\nexport default FileController;\r\n\r\n// export interface PhotoData {\r\n//     id: String,\r\n//     album: String,\r\n//     originalName: String,\r\n//     url: String,\r\n//     lastChange: String,\r\n//     history: singleChange[]\r\n// }\r\n","import sharp from \"sharp\";\r\nimport FileController from \"./fileController\";\r\nimport userController from \"./userController\";\r\n\r\nexport async function getMetadata(\r\n  photoId: number\r\n): Promise<sharp.Metadata | string> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        let meta = await sharp(photo.url).metadata();\r\n        resolve(meta);\r\n      } else {\r\n        resolve(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err.message);\r\n    }\r\n  });\r\n}\r\n//toDo edutuj historie zdjecia zamiast tworzyc nowe dane po filtrze\r\nexport async function rotate(photoId: number, angle: number): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .rotate(angle)\r\n          .toFile(`temp/${photo.originalName}_rotate.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_rotate.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function resize(\r\n  photoId: number,\r\n  width: number,\r\n  height: number\r\n): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .resize(width, height)\r\n          .toFile(`temp/${photo.originalName}_resize.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_resize.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\n//toDo funkcja uploadPhoto i tak zrobi z tego jpg, napraw potem\r\nexport async function reformat(photoId: number): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url).toFile(`temp/${photo.originalName}.png`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \".png\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function crop(\r\n  photoId: number,\r\n  region: sharp.Region\r\n): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .extract(region)\r\n          .toFile(`temp/${photo.originalName}_crop.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_crop.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function grayScale(photoId: number): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .grayscale()\r\n          .toFile(`temp/${photo.originalName}_grayScale.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_grayScale.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function flip(photoId: number): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .flip()\r\n          .toFile(`temp/${photo.originalName}_flip.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_flip.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\nexport async function flop(photoId: number): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .flop()\r\n          .toFile(`temp/${photo.originalName}_flop.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_flop.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function negate(photoId: number): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .grayscale()\r\n          .toFile(`temp/${photo.originalName}_negate.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_negate.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function tint(\r\n  photoId: number,\r\n  color: sharp.Color\r\n): Promise<number> {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const photo = FileController.findPhotoById(photoId);\r\n      if (photo !== undefined) {\r\n        await sharp(photo.url)\r\n          .tint(color)\r\n          .toFile(`temp/${photo.originalName}_tint.jpg`);\r\n        const newPhoto = FileController.uploadPhoto(\r\n          photo.originalName + \"_tint.jpg\",\r\n          photo.album,\r\n          photo.userId\r\n        );\r\n        resolve(newPhoto.id);\r\n      } else {\r\n        reject(\"not found\");\r\n      }\r\n    } catch (err) {\r\n      reject(err);\r\n    }\r\n  });\r\n}\r\n","import { tagsList, nextTagId, photoList } from \"../model\";\r\n\r\nexport function addTag(name:string, popularity?: number):boolean\r\n{\r\n    if(tagsList.findIndex(tag => tag.name == name) == -1)\r\n    {\r\n        tagsList.push({\r\n            name: name,\r\n            popularity: popularity ?? 0,\r\n            id: nextTagId.id\r\n        })\r\n      return true\r\n    }\r\n   return false;\r\n}\r\n\r\nexport function bindTag(photoId:number, tagId:number[]):boolean\r\n{\r\n  let success = true;\r\n  const photo = photoList.find(photo => photo.id == photoId)\r\n\r\n  \r\n    tagId.forEach(id => {\r\n      const tag = tagsList.find(tag => tag.id == id)\r\n      if(tag !== undefined && !photo.tagList.includes(tag.name))\r\n        photo.tagList.push(tag.name)\r\n      else\r\n      success = false\r\n    })\r\n  \r\n\r\n  return success;\r\n}","import {\r\n  nextUserId,\r\n  tokenBinding,\r\n  tokenStructure,\r\n  user,\r\n  userList,\r\n} from \"../model\";\r\nimport * as jwt from \"jsonwebtoken\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport { IncomingMessage } from \"http\";\r\nimport { getPostData } from \"../getRequestData\";\r\nrequire(\"dotenv\").config();\r\n\r\nclass UserController {\r\n  async reqisterUser(\r\n    name: string,\r\n    lastName: string,\r\n    email: string,\r\n    password: string\r\n  ) {\r\n    const encPassword = await bcrypt.hash(password, 10);\r\n    const newUser: user = {\r\n      name,\r\n      lastName,\r\n      email,\r\n      password: encPassword,\r\n      confirmed: false,\r\n      id: nextUserId.id,\r\n      photosId: [],\r\n      profilePic: null,\r\n    };\r\n    userList.push(newUser);\r\n    const token = await this.createToken(newUser.email, \"5m\");\r\n    return token;\r\n  }\r\n\r\n  async confirmUser(token: string) {\r\n    return new Promise(async (resolve, reject) => {\r\n      try {\r\n        const turnOut = (await this.checkToken(token)) as unknown as {\r\n          email: string;\r\n          iat: number;\r\n          exp: number;\r\n        };\r\n        console.log(turnOut);\r\n        const toConfirm = userList.find((el) => el.email == turnOut.email);\r\n\r\n        toConfirm.confirmed = true;\r\n        console.log(toConfirm);\r\n        resolve(true);\r\n      } catch {\r\n        resolve(false);\r\n      }\r\n    });\r\n  }\r\n  async createToken(email: string, time: string) {\r\n    let token = await jwt.sign(\r\n      { email: email },\r\n      process.env.SECRET_KEY, // powinno byÄ‡ w .env\r\n      {\r\n        expiresIn: time, // \"1m\", \"1d\", \"24h\"\r\n      }\r\n    );\r\n    console.log({ token: token });\r\n    return token;\r\n  }\r\n  async checkToken(token: string) {\r\n    const decode = await jwt.verify(token, process.env.SECRET_KEY);\r\n    return decode;\r\n  }\r\n  async login(email: string, password: string): Promise<boolean | string> {\r\n    const toCheck = userList.find((el) => el.email == email);\r\n    let passCheck = await bcrypt.compare(password, toCheck.password);\r\n    console.log(passCheck, toCheck.confirmed);\r\n    if (passCheck && toCheck.confirmed) {\r\n      const userId = toCheck.id;\r\n      const token = await this.createToken(email, \"1h\");\r\n      tokenBinding.push({ userId, token });\r\n      return token;\r\n    }\r\n    return false;\r\n  }\r\n  async checkLoginToken(token: string) {\r\n    const decode = await jwt.verify(token, process.env.SECRET_KEY);\r\n    return decode;\r\n  }\r\n  async verifyLogin(req: IncomingMessage): Promise<tokenStructure> {\r\n    return new Promise(async (resolve, reject) => {\r\n      console.log(req.headers);\r\n      if (req.headers.authorization) {\r\n        try {\r\n          const tokenInsights = jwt.decode(\r\n            req.headers.authorization\r\n          ) as tokenStructure;\r\n          const now = Math.floor(Date.now() / 1000);\r\n          const user = userList.find((us) => us.email == tokenInsights.email);\r\n          if (now < tokenInsights.exp && user != undefined) {\r\n            resolve(tokenInsights);\r\n          } else {\r\n            reject(\"token expired\");\r\n          }\r\n        } catch {\r\n          reject(\"incorrect token\");\r\n        }\r\n      }\r\n      reject(\"no authorization token\");\r\n    });\r\n  }\r\n}\r\nvar userController = new UserController();\r\nexport default userController;\r\n","import { IncomingMessage } from \"http\";\r\n\r\nexport async function getPostData(req: IncomingMessage):Promise<string>\r\n{\r\n    return new Promise((resolve, reject) =>{\r\n        try {\r\n            let body = \"\"\r\n\r\n            req.on(\"data\", part => {\r\n                body += part.toString()\r\n            })\r\n    \r\n            req.on(\"end\", () => {\r\n                resolve(body)\r\n            })\r\n    \r\n        }\r\n        catch (err)\r\n        {\r\n            reject(err)\r\n        }\r\n        \r\n    })\r\n}","interface singleChange {\r\n  status: string;\r\n  lastModifiedDate: string;\r\n  url: string;\r\n}\r\nexport interface tokenStructure {\r\n  email: string;\r\n  iat: number;\r\n  exp: number;\r\n}\r\n\r\nexport interface PhotoData {\r\n  id: number;\r\n  album: string;\r\n  originalName: string;\r\n  url: string;\r\n  lastChange: string;\r\n  history: singleChange[];\r\n  tagList: string[];\r\n  userId: number;\r\n}\r\n\r\nexport interface TagData {\r\n  id: number;\r\n  name: string;\r\n  popularity: number;\r\n}\r\n\r\nexport interface UpdatePhotoTagsData {\r\n  photoId: number;\r\n  tagName: string | string[];\r\n}\r\nexport interface user {\r\n  id: number;\r\n  name: string;\r\n  lastName: string;\r\n  email: string;\r\n  confirmed: boolean;\r\n  password: string;\r\n  photosId: number[];\r\n  profilePic: number | null;\r\n}\r\nexport let nextUserId = {\r\n  _id: 6,\r\n  get id(): number {\r\n    this._id += 1;\r\n    return this._id;\r\n  },\r\n};\r\nexport const userList: user[] = [];\r\nexport const tokenBinding: { userId: number; token: string }[] = [];\r\nexport const tagsList: TagData[] = [\r\n  {\r\n    id: 0,\r\n    name: \"#love\",\r\n    popularity: 0,\r\n  },\r\n  {\r\n    id: 1,\r\n    name: \"#instagood\",\r\n    popularity: 0,\r\n  },\r\n  {\r\n    id: 2,\r\n    name: \"#fashion\",\r\n    popularity: 0,\r\n  },\r\n  {\r\n    id: 3,\r\n    name: \"#photooftheday\",\r\n    popularity: 0,\r\n  },\r\n  {\r\n    id: 4,\r\n    name: \"#beautiful\",\r\n    popularity: 0,\r\n  },\r\n  {\r\n    id: 5,\r\n    name: \"#art\",\r\n    popularity: 0,\r\n  },\r\n];\r\nexport let nextTagId = {\r\n  _id: 6,\r\n  get id(): number {\r\n    this._id += 1;\r\n    return this._id;\r\n  },\r\n};\r\n\r\nexport const photoList: PhotoData[] = [];\r\nexport let nextPhotoId = {\r\n  _id: 0,\r\n  get id(): number {\r\n    this._id += 1;\r\n    return this._id;\r\n  },\r\n};\r\n\r\nexport interface post {\r\n  userId: number;\r\n  email: string;\r\n  title: string;\r\n  content: string;\r\n  photoId: number[];\r\n  id: number;\r\n}\r\nexport let nextPostId = {\r\n  _id: 0,\r\n  get id(): number {\r\n    this._id += 1;\r\n    return this._id;\r\n  },\r\n};\r\nexport const postList: post[] = [];\r\n","import { IncomingMessage, ServerResponse } from \"http\";\r\nimport {\r\n  getMetadata,\r\n  rotate,\r\n  resize,\r\n  reformat,\r\n  crop,\r\n  grayScale,\r\n  flop,\r\n  flip,\r\n  negate,\r\n  tint,\r\n} from \"../controller/filtersController\";\r\n\r\nexport default async function filtersRouter(\r\n  req: IncomingMessage,\r\n  res: ServerResponse\r\n) {\r\n  if (req.method === \"GET\") {\r\n    if (req.url.match(/metadata\\/[0-9]*$/)) {\r\n      const temp = req.url.split(\"/\");\r\n      const id = temp[temp.length - 1] as unknown as number;\r\n      const meta = await getMetadata(id);\r\n      res.statusCode = 200;\r\n      res.statusMessage = \"ok\";\r\n      res.write(JSON.stringify(meta));\r\n      res.end();\r\n    } else if (req.url.match(/getfile\\/[0-9]\\//)) {\r\n      const temp = req.url.split(\"/\");\r\n      let newID;\r\n      switch (temp[temp.length - 1]) {\r\n        case \"rotate\":\r\n          newID = await rotate(temp[temp.length - 2] as unknown as number, 90);\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"resize\":\r\n          newID = await resize(\r\n            temp[temp.length - 2] as unknown as number,\r\n            200,\r\n            200\r\n          );\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"reformat\":\r\n          newID = await reformat(temp[temp.length - 2] as unknown as number);\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"crop\":\r\n          newID = await crop(temp[temp.length - 2] as unknown as number, {\r\n            width: 100,\r\n            height: 100,\r\n            left: 0,\r\n            top: 0,\r\n          });\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"grayScale\":\r\n          newID = await grayScale(temp[temp.length - 2] as unknown as number);\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"flip\":\r\n          newID = await flip(temp[temp.length - 2] as unknown as number);\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"flop\":\r\n          newID = await flop(temp[temp.length - 2] as unknown as number);\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"negate\":\r\n          newID = await negate(temp[temp.length - 2] as unknown as number);\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n        case \"tint\":\r\n          newID = await tint(temp[temp.length - 2] as unknown as number, \"red\");\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"ok\";\r\n          res.end(newID + \"\");\r\n          break;\r\n      }\r\n    }\r\n  } else if (req.method === \"PATCH\") {\r\n  }\r\n}\r\n","import * as formidable from \"formidable\";\r\nimport { IncomingMessage, ServerResponse } from \"http\";\r\nimport FileController from \"../controller/fileController\";\r\nimport { getPostData } from \"../getRequestData\";\r\nimport { photoList, postList, userList } from \"../model\";\r\nimport userController from \"../controller/userController\";\r\nimport { JwtPayload } from \"jsonwebtoken\";\r\nimport fs from \"fs\";\r\n\r\nexport default async function imageRouter(\r\n  req: IncomingMessage,\r\n  res: ServerResponse\r\n) {\r\n  switch (req.method) {\r\n    case \"GET\":\r\n      const [path, params] = req.url.split(/\\?/);\r\n      if (path == \"/api/photos\") {\r\n        res.statusCode = 200;\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n\r\n        res.end(JSON.stringify(photoList));\r\n        //pobierz wszystkie\r\n        res.end();\r\n      } else if (req.url.match(/api\\/photos\\/[0-9]+/)) {\r\n        const xd = req.url.split(/\\//g);\r\n        const id: number = parseInt(xd[xd.length - 1]);\r\n        const photo = photoList.find((img) => img.id == id);\r\n        let url = __dirname + photo.url;\r\n        url = url.replace(/\\/\\//g, \"/\");\r\n        res.setHeader(\"content-type\", \"image/jpg\");\r\n        res.statusCode = 200;\r\n        var readStream = fs.createReadStream(url);\r\n        readStream.pipe(res);\r\n\r\n        //pobierz jedno zdjÄ™cie\r\n        res.end();\r\n      } else if (req.url.match(/api\\/photos\\/post/)) {\r\n        console.log(\"xd\");\r\n        res.statusCode = 200;\r\n        res.end(JSON.stringify(postList));\r\n      } else if (req.url.match(/api\\/photos\\/profile/)) {\r\n        const token = await userController.verifyLogin(req);\r\n        const user = userList.find((us) => us.email == token.email);\r\n        res.statusCode = 200;\r\n        res.end(\r\n          JSON.stringify({\r\n            name: user.name,\r\n            lastName: user.lastName,\r\n            photoId: user.profilePic,\r\n            email: user.email,\r\n          })\r\n        );\r\n      }\r\n      break;\r\n    case \"POST\":\r\n      if (req.url == \"/api/photos\") {\r\n        const form = formidable({ multiples: true, uploadDir: \"./temp\" });\r\n\r\n        console.log(form);\r\n        form.parse(req, (err, fields, files) => {\r\n          if (err) {\r\n            console.log(res);\r\n            res.statusCode = err.httpCode || 404;\r\n            res.statusMessage = String(err);\r\n            res.end();\r\n            return;\r\n          }\r\n\r\n          userController\r\n            .verifyLogin(req)\r\n            .then((token) => {\r\n              const user = userList.find((val) => val.email == token.email);\r\n              const photo = FileController.uploadPhoto(\r\n                (files.file as unknown as formidable.File).newFilename,\r\n                (fields as unknown as { album: string }).album,\r\n                user.id\r\n              );\r\n              res.statusCode = 200;\r\n              res.setHeader(\"content-type\", \"application/json\");\r\n              res.end(JSON.stringify({ ok: \"ok\", ...photo }));\r\n            })\r\n            .catch((err) => {\r\n              res.statusCode = 400;\r\n              res.end(err);\r\n            });\r\n        });\r\n      }\r\n      if (req.url.match(/photos\\/post/)) {\r\n        const body = await getPostData(req);\r\n        const data = JSON.parse(body);\r\n        try {\r\n          const token = await userController.verifyLogin(req);\r\n\r\n          FileController.createNewPost(\r\n            data.title,\r\n            data.content,\r\n            data.photoId,\r\n            token.email\r\n          );\r\n          res.statusCode = 201;\r\n          res.statusMessage = \"ok\";\r\n          res.end();\r\n        } catch (err) {\r\n          res.statusCode = 401;\r\n          res.statusMessage = \"invalid token\";\r\n          res.end(err);\r\n        }\r\n      }\r\n      break;\r\n    case \"DELETE\":\r\n      if (req.url.match(/api\\/photos\\/post\\/[0-9]*/)) {\r\n        try {\r\n          const url = req.url.split(/\\//g);\r\n          const id = parseInt(url[url.length - 1]);\r\n          const token = await userController.verifyLogin(req);\r\n          const post = FileController.deletePost(id, token.email);\r\n          if (post) {\r\n            res.statusCode = 200;\r\n            res.setHeader(\"content-type\", \"application/json\");\r\n            res.end(post);\r\n          } else {\r\n            res.statusCode = 403;\r\n            res.statusMessage = \"forbidden\";\r\n            res.end(\"You can only delete your own posts\");\r\n          }\r\n        } catch (err) {\r\n          res.statusCode = 401;\r\n          res.statusMessage = \"err\";\r\n          res.end(err);\r\n        }\r\n      } else if (req.url.match(/photos\\/[0-9]*/)) {\r\n      }\r\n\r\n      break;\r\n    case \"PATCH\":\r\n      if (req.url.match(/api\\/photos\\/[0-9]*/)) {\r\n        res.statusCode = 200;\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n        const body = await getPostData(req);\r\n        //edytuj jedno zdjecie\r\n        res.end(JSON.stringify(body));\r\n      }\r\n      break;\r\n  }\r\n}\r\n","import { IncomingMessage, ServerResponse } from \"http\";\r\nimport { url } from \"inspector\";\r\nimport { getPostData } from \"../getRequestData\";\r\nimport { photoList, tagsList, UpdatePhotoTagsData } from \"../model\";\r\nimport { addTag, bindTag } from \"../controller/tagsController\";\r\n\r\nexport default async function tagRouter(\r\n  req: IncomingMessage,\r\n  res: ServerResponse<IncomingMessage>\r\n) {\r\n  switch (req.method) {\r\n    case \"GET\":\r\n      const [path, args] = req.url.split(\"?\");\r\n      console.log(path)\r\n      if (path.match(/raw/)) {\r\n        res.statusCode = 200;\r\n        res.statusMessage = \"ok\";\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n\r\n        const stringList = tagsList.map((tag) => {\r\n          return tag.name;\r\n        });\r\n        res.write(JSON.stringify(stringList));\r\n        res.end();\r\n      } else if (path.match(/tags$/)) {\r\n        res.statusCode = 200;\r\n        res.statusMessage = \"ok\";\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n        res.write(JSON.stringify(tagsList));\r\n        res.end();\r\n      } else if (path.match(/tags\\/[0-9]*/)) {\r\n        \r\n        const id = path.split(/\\/tags\\//)[1] as unknown as number;\r\n        const photo = photoList.find(photo => photo.id == id)\r\n        if(photo === undefined)\r\n        {\r\n          res.statusMessage = \"I'm not ok\"\r\n          res.statusCode = 403\r\n          res.end()\r\n          return;\r\n        }\r\n\r\n\r\n        \r\n        const tag = photo.tagList.map(\r\n          name => {\r\n           const tag =  tagsList.find((tag) => tag.name == name);\r\n           if(tag !== undefined)\r\n           return tag\r\n          }\r\n        )\r\n        \r\n        \r\n\r\n        res.statusCode = 200;\r\n        res.statusMessage = \"ok\";\r\n        res.setHeader(\"content-type\", \"application/json\");\r\n        res.write(JSON.stringify(tag));\r\n        res.end();\r\n      }\r\n      break;\r\n\r\n    case \"POST\":\r\n      if (req.url.match(/^\\/api\\/tags$/)) {\r\n        getPostData(req).then((body) => {\r\n          console.log(body)\r\n          const obj = JSON.parse(body) as {name: string, popularity?: number}\r\n          obj.name = \"#\" + obj.name.replace(/\\#/g, \"\")\r\n\r\n          console.log(obj)\r\n\r\n          const ok = addTag(obj.name, obj.popularity)\r\n          if(ok){\r\n            res.statusCode = 200\r\n            res.statusMessage = \"ok\"\r\n            res.end()\r\n          }\r\n          else{\r\n            res.statusCode = 400\r\n            res.statusMessage = \"this tag probably already exists\"\r\n            res.end()\r\n          }\r\n        });\r\n      }\r\n      break;\r\n\r\n    case \"PATCH\":\r\n        if(req.url.match(/api\\/photos\\/tags$/))\r\n        {\r\n            const body:string = await getPostData(req) as string;\r\n            const obj = JSON.parse(body) as UpdatePhotoTagsData\r\n            obj.tagName = \"#\" + (obj.tagName as string).replace(/\\#/g, \"\")\r\n            const tagId = tagsList.find(tag => tag.name == obj.tagName).id \r\n            if(bindTag(obj.photoId, [tagId]))\r\n            {\r\n              res.statusMessage = \"ok\"\r\n              res.statusCode = 200\r\n            }\r\n            else\r\n            {\r\n              res.statusMessage = \"I'm not ok\"\r\n              res.statusCode = 403\r\n            }\r\n            res.end()  \r\n        }\r\n        else if(req.url.match(/api\\/photos\\/tags\\/mass$/))\r\n        {\r\n          const body:string = await getPostData(req) as string;\r\n          const obj = JSON.parse(body) as UpdatePhotoTagsData\r\n          \r\n          const tagId = (obj.tagName as string[]).map(name => {\r\n            const tag = tagsList.find(el => name == el.name)\r\n            if(tag !== undefined)\r\n              return tag.id;\r\n          });\r\n\r\n          if(bindTag(obj.photoId, tagId))\r\n            {\r\n              res.statusMessage = \"ok\"\r\n              res.statusCode = 200\r\n            }\r\n            else\r\n            {\r\n              res.statusMessage = \"I'm not ok\"\r\n              res.statusCode = 403\r\n            }\r\n            res.end()  \r\n          \r\n          \r\n        break;\r\n          }\r\n  }\r\n  return;\r\n}\r\n","import { IncomingMessage, ServerResponse } from \"http\";\r\nimport userController from \"../controller/userController\";\r\nimport { getPostData } from \"../getRequestData\";\r\nimport { userList } from \"../model\";\r\n\r\nexport default async function userRouter(\r\n  req: IncomingMessage,\r\n  res: ServerResponse<IncomingMessage>\r\n) {\r\n  switch (req.method) {\r\n    case \"POST\":\r\n      if (req.url.match(/\\/register/)) {\r\n        const body = await getPostData(req);\r\n        const user = JSON.parse(body) as unknown as {\r\n          name: string;\r\n          lastName: string;\r\n          email: string;\r\n          password: string;\r\n        };\r\n        const test = userList.find((val) => val.email == user.email);\r\n        if (\r\n          user.name != undefined &&\r\n          user.lastName != undefined &&\r\n          user.email != undefined &&\r\n          user.password != undefined &&\r\n          test == undefined\r\n        ) {\r\n          const token = await userController.reqisterUser(\r\n            user.name,\r\n            user.lastName,\r\n            user.email,\r\n            user.password\r\n          );\r\n          res.statusCode = 201;\r\n          res.statusMessage = \"ok\";\r\n          res.end(token);\r\n        }\r\n        res.statusCode = 400;\r\n        res.statusMessage = \"im not ok\";\r\n        res.end();\r\n      }\r\n      if (req.url.match(/\\/login/)) {\r\n        const body = await getPostData(req);\r\n        const data = JSON.parse(body) as unknown as {\r\n          email: string;\r\n          password: string;\r\n        };\r\n        const result = await userController.login(data.email, data.password);\r\n        if (result) {\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"pomyslnie zalogowano\";\r\n          res.end(result);\r\n        } else {\r\n          res.statusCode = 400;\r\n          res.statusMessage = \"err\";\r\n          res.end(\r\n            \"upewnij siÄ™ Å¼e hasÅ‚o jest poprawne, a adres email potwierdzony\"\r\n          );\r\n        }\r\n      }\r\n      break;\r\n    case \"GET\":\r\n      if (req.url.match(/\\/confirm\\/.+$/)) {\r\n        const phases = req.url.split(\"/\");\r\n        const token = phases[phases.length - 1];\r\n        let status = await userController.confirmUser(token);\r\n        if (status) {\r\n          res.statusCode = 200;\r\n          res.statusMessage = \"successfully confirmed\";\r\n          console.log(\"confirm\");\r\n          res.end(JSON.stringify(\"successfully confirmed\"));\r\n        } else {\r\n          res.statusCode = 401;\r\n          res.statusMessage = \"bad token\";\r\n          res.end(\"err\");\r\n        }\r\n      }\r\n  }\r\n}\r\n","module.exports = require(\"bcryptjs\");","module.exports = require(\"dotenv\");","module.exports = require(\"formidable\");","module.exports = require(\"http\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"sharp\");","module.exports = require(\"fs\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { createServer } from \"http\";\r\nimport userController from \"./app/controller/userController\";\r\nimport filtersRouter from \"./app/router/filtersRouter\";\r\nimport imageRouter from \"./app/router/imageRouter\";\r\nimport tagRouter from \"./app/router/tagsRouter\";\r\nimport userRouter from \"./app/router/userRouter\";\r\nrequire(\"dotenv\").config();\r\n\r\nconst server = createServer((req, res) => {\r\n  userController.verifyLogin(req).then(\r\n    (token) => {\r\n      if (req.url.match(/tags/)) tagRouter(req, res);\r\n      else if (req.url.match(/\\/api\\/photos/)) imageRouter(req, res);\r\n      else if (req.url.match(/api\\/filters/)) filtersRouter(req, res);\r\n      else {\r\n        res.statusCode = 400;\r\n        res.statusMessage = \"bad request\";\r\n        res.end();\r\n      }\r\n    },\r\n    (reason) => {\r\n      if ((reason = \"no authorization token\")) {\r\n        console.log(req.url);\r\n        if (req.url.match(/api\\/user/)) userRouter(req, res);\r\n      } else if (reason == \"token expired\") {\r\n        res.statusCode = 403;\r\n        res.statusMessage = \"token expired\";\r\n        res.end(JSON.stringify(\"\"));\r\n      } else {\r\n        res.statusCode = 400;\r\n        res.statusMessage = \"bad request\";\r\n        res.end(reason);\r\n      }\r\n    }\r\n  );\r\n});\r\n\r\nserver.listen(process.env.APP_PORT, () => {\r\n  console.log(\"Start on \" + process.env.APP_PORT);\r\n});\r\n"],"names":[],"sourceRoot":""}